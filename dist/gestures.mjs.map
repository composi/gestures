{"version":3,"file":"gestures.mjs.map","sources":["../src/gestures.js"],"sourcesContent":["/**\n * @type {string} eventStart\n */\nvar eventStart\n/**\n * @type {string} eventEnd\n */\nvar eventEnd\n/**\n * @type {string} eventMove\n */\nvar eventMove\n/**\n * @type {string} eventCancel\n */\nvar eventCancel\n\n// Pointer events for IE11 and MSEdge:\nif (window.navigator.pointerEnabled) {\n  eventStart = 'pointerdown'\n  eventEnd = 'pointerup'\n  eventMove = 'pointermove'\n  eventCancel = 'pointercancel'\n\n  // Pointer events for IE10 and WP8:\n} else if (window.navigator.msPointerEnabled) {\n  eventStart = 'MSPointerDown'\n  eventEnd = 'MSPointerUp'\n  eventMove = 'MSPointerMove'\n  eventCancel = 'MSPointerCancel'\n\n  // Touch events for iOS & Android:\n} else if ('ontouchstart' in window) {\n  eventStart = 'touchstart'\n  eventEnd = 'touchend'\n  eventMove = 'touchmove'\n  eventCancel = 'touchcancel'\n\n  // Mouse events for desktop:\n} else {\n  eventStart = 'mousedown'\n  eventEnd = 'mouseup'\n  eventMove = 'mousemove'\n  eventCancel = 'mouseout'\n}\nexport { eventStart, eventEnd, eventMove, eventCancel }\n\n/**\n * Fire a gesture on an element and pass it some optional data.\n * @param {Element} el\n * @param {string} event\n * @param {*} [data]\n */\nexport function trigger(el, event, data) {\n  if (!event) {\n    console.error('No event was provided. You do need to provide one.')\n    return\n  }\n  if (typeof el === 'string') el = document.querySelector(el)\n  if (document.createEvent) {\n    var evtObj = document.createEvent('Events')\n    evtObj.initEvent(event, true, false)\n    evtObj['data'] = data\n    el.dispatchEvent(evtObj)\n  }\n}\n\n/**\n * Enable gestures in the browser.\n * @return {void} undefined\n */\nexport var gestures = function() {\n  var touch = {}\n  var touchTimeout\n  var swipeTimeout\n  var tapTimeout\n  var longTapDelay = 750\n  var singleTapDelay = 150\n  var gestureLength = 20\n  if (/android/gim.test(navigator.userAgent)) singleTapDelay = 200\n  var longTapTimeout\n\n  /**\n   * @param {Node} node\n   */\n  function parentIfText(node) {\n    return 'tagName' in node ? node : node.parentNode\n  }\n\n  /**\n   * @param {number} x1\n   * @param {number} x2\n   * @param {number} y1\n   * @param {number} y2\n   */\n  function swipeDirection(x1, x2, y1, y2) {\n    return Math.abs(x1 - x2) >= Math.abs(y1 - y2)\n      ? x1 - x2 > 0\n        ? 'left'\n        : 'right'\n      : y1 - y2 > 0\n      ? 'up'\n      : 'down'\n  }\n\n  function longTap() {\n    longTapTimeout = null\n    if (touch.last) {\n      try {\n        if (touch && touch.el) {\n          trigger(touch.el, 'longtap')\n          touch = {}\n        }\n      } catch (err) {}\n    }\n  }\n\n  function cancelLongTap() {\n    if (longTapTimeout) clearTimeout(longTapTimeout)\n    longTapTimeout = null\n  }\n\n  function cancelAll() {\n    if (touchTimeout) clearTimeout(touchTimeout)\n    if (tapTimeout) clearTimeout(tapTimeout)\n    if (swipeTimeout) clearTimeout(swipeTimeout)\n    if (longTapTimeout) clearTimeout(longTapTimeout)\n    touchTimeout = tapTimeout = swipeTimeout = longTapTimeout = null\n    touch = {}\n  }\n\n  /**\n   * Execute this after DOM loads:\n   */\n  ;(function() {\n    var now\n    var delta\n    var body = document.body\n\n    /**\n     * Capture start of event:\n     */\n    body.addEventListener(eventStart, function(e) {\n      now = Date.now()\n      delta = now - (touch.last || now)\n\n      if (eventStart === 'mousedown') {\n        touch.el = parentIfText(/** @type{Node} */ (e.target))\n        if (e.target['nodeName'] === 'ripple') {\n          touch.el = e.target['parentNode']\n        }\n        touchTimeout && clearTimeout(touchTimeout)\n        touch.x1 = e['pageX']\n        touch.y1 = e['pageY']\n\n        /**\n         * Detect one finger gesture:\n         */\n      } else {\n        if (e['touches'].length === 1) {\n          if (!!e.target['disabled']) return\n          touch.el = parentIfText(e['touches'][0].target)\n          touchTimeout && clearTimeout(touchTimeout)\n          touch.x1 = e['touches'][0]['pageX']\n          touch.y1 = e['touches'][0]['pageY']\n        }\n      }\n\n      if (delta > 0 && delta <= 450) {\n        touch.isDoubleTap = true\n      }\n      touch.last = now\n      longTapTimeout = setTimeout(longTap, longTapDelay)\n    })\n\n    /**\n     * Capture event move:\n     */\n    body.addEventListener(eventMove, function(e) {\n      cancelLongTap()\n      if (eventMove === 'mousemove') {\n        touch.x2 = e['pageX']\n        touch.y2 = e['pageY']\n      } else {\n        /**\n         * One finger gesture:\n         */\n        if (e['touches'].length === 1) {\n          touch.x2 = e['touches'][0]['pageX']\n          touch.y2 = e['touches'][0]['pageY']\n          touch.move = true\n        } else if (e['touches'].length === 2) {\n          // TODO: pinch - rotate gestures?\n        }\n      }\n    })\n\n    /**\n     * Capture event end:\n     */\n    body.addEventListener(eventEnd, function(e) {\n      cancelLongTap()\n      if (!!touch.el) {\n        /**\n         * Swipe detection:\n         */\n        if (\n          (touch.x2 && Math.abs(touch.x1 - touch.x2) > gestureLength) ||\n          (touch.y2 && Math.abs(touch.y1 - touch.y2) > gestureLength)\n        ) {\n          swipeTimeout = setTimeout(function() {\n            if (touch && touch.el) {\n              var direction = swipeDirection(\n                touch.x1,\n                touch.x2,\n                touch.y1,\n                touch.y2\n              )\n              trigger(touch.el, 'swipe', direction)\n              trigger(touch.el, 'swipe' + direction)\n              touch = {}\n            }\n          }, 0)\n\n          /**\n           * Normal tap:\n           */\n        } else if ('last' in touch) {\n          /**\n           * Delay by one tick so we can cancel the 'tap' event if 'scroll' fires:\n           */\n          tapTimeout = setTimeout(function() {\n            /**\n             * Trigger double tap immediately:\n             */\n            if (touch && touch.isDoubleTap) {\n              if (touch && touch.el) {\n                trigger(touch.el, 'dbltap')\n                e.preventDefault()\n                touch = {}\n              }\n            } else {\n              /**\n               * Trigger tap after singleTapDelay:\n               */\n              touchTimeout = setTimeout(function() {\n                touchTimeout = null\n                if (touch && touch.el && !touch.move) {\n                  trigger(touch.el, 'tap')\n                  touch = {}\n                } else {\n                  /**\n                   * Touch moved, so cancel tap:\n                   */\n                  cancelAll()\n                }\n              }, singleTapDelay)\n            }\n          }, 0)\n        }\n      } else {\n        return\n      }\n    })\n    body.addEventListener('touchcancel', cancelAll)\n  })()\n}\n\n/**\n * Function to disable text selection. Use with make swipe events not select the element's text.\n * @param {Element} element\n * @param {string | boolean} [all]\n * @return {void} undefined\n */\nexport function disableTextSelection(element, all) {\n  if (!element) return\n  if (all && typeof element === 'string') {\n    var elements = Array.prototype.slice.call(\n      document.querySelectorAll(element)\n    )\n    elements.map(function(element) {\n      element.classList.add('disable-user-select')\n    })\n  } else {\n    if (typeof element === 'string') {\n      element = document.querySelector(element)\n      element.classList.add('disable-user-select')\n    }\n  }\n  var stylesheet = document.head.querySelector('.disable-user-select')\n  if (!stylesheet) {\n    stylesheet = document.createElement('style')\n    stylesheet.className = 'disable-user-select'\n    stylesheet.innerHTML =\n      '.disable-user-select, .disable-user-select * { user-select: none; -webkit-user-select: none; -ms-user-select: none; }'\n    document.head.appendChild(stylesheet)\n  }\n}\n\n/**\n * Function to remove a style set to disable text selection. This will re-enable text selection.\n * @param {Element} element\n * @param {string | boolean} all\n * @return {void} undefined\n */\nexport function enableTextSelection(element, all) {\n  if (all && typeof element === 'string') {\n    var elements = Array.prototype.slice.call(\n      document.querySelectorAll(element)\n    )\n    elements.map(function(element) {\n      element.classList.remove('disable-user-select')\n    })\n  } else {\n    if (typeof element === 'string') element = document.querySelector(element)\n    if (!element) return\n    element.classList.remove('disable-user-select')\n  }\n}\n"],"names":["eventStart","eventEnd","eventMove","eventCancel","window","navigator","pointerEnabled","msPointerEnabled","trigger","el","event","data","console","error","document","querySelector","createEvent","evtObj","initEvent","dispatchEvent","gestures","Math","abs","parentIfText","node","parentNode","swipeDirection","x1","x2","y1","y2","longTap","longTapTimeout","touch","last","err","cancelLongTap","clearTimeout","cancelAll","touchTimeout","tapTimeout","swipeTimeout","singleTapDelay","gestureLength","test","userAgent","now","delta","body","addEventListener","e","Date","target","length","isDoubleTap","setTimeout","move","direction","preventDefault","disableTextSelection","element","all","elements","Array","prototype","slice","call","querySelectorAll","map","classList","add","stylesheet","head","createElement","className","innerHTML","appendChild","enableTextSelection","remove"],"mappings":"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"}