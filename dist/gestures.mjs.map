{"version":3,"file":"gestures.mjs.map","sources":["../src/gestures.js"],"sourcesContent":["/**\n * @type {string} eventstart\n */\nvar eventstart\n/**\n * @type {string} eventend\n */\nvar eventend\n/**\n * @type {string} eventmove\n */\nvar eventmove\n/**\n * @type {string} eventcancel\n */\nvar eventcancel\n\n// Pointer events for IE11 and MSEdge:\nif (window.navigator.pointerEnabled) {\n  eventstart = 'pointerdown'\n  eventend = 'pointerup'\n  eventmove = 'pointermove'\n  eventcancel = 'pointercancel'\n\n  // Pointer events for IE10 and WP8:\n} else if (window.navigator.msPointerEnabled) {\n  eventstart = 'MSPointerDown'\n  eventend = 'MSPointerUp'\n  eventmove = 'MSPointerMove'\n  eventcancel = 'MSPointerCancel'\n\n  // Touch events for iOS & Android:\n} else if ('ontouchstart' in window) {\n  eventstart = 'touchstart'\n  eventend = 'touchend'\n  eventmove = 'touchmove'\n  eventcancel = 'touchcancel'\n\n  // Mouse events for desktop:\n} else {\n  eventstart = 'mousedown'\n  eventend = 'mouseup'\n  eventmove = 'mousemove'\n  eventcancel = 'mouseout'\n}\nexport { eventstart, eventend, eventmove, eventcancel }\n\n/**\n * Fire a gesture on an element and pass it some optional data.\n * @param {Element} el\n * @param {string} event\n * @param {*} [data]\n * @param {Event} originalEvent\n */\nexport function trigger(el, event, data, originalEvent) {\n  if (!event) {\n    console.error('No event was provided. You do need to provide one.')\n    return\n  }\n  if (typeof el === 'string') el = document.querySelector(el)\n  if (document.createEvent) {\n    var evtObj = document.createEvent('Events')\n    evtObj.initEvent(event, true, false)\n    evtObj['data'] = data\n    evtObj['originalEvent'] = originalEvent\n    el.dispatchEvent(evtObj)\n  }\n}\n\n/**\n * Enable gestures in the browser.\n * @return {void} undefined\n */\nexport var gestures = function(target) {\n  var touch = {}\n  var touchTimeout\n  var swipeTimeout\n  var tapTimeout\n  var longTapDelay = 750\n  var singleTapDelay = 150\n  var gestureLength = 20\n  if (/android/gim.test(navigator.userAgent)) singleTapDelay = 200\n  var longTapTimeout\n\n  /**\n   * @param {Node} node\n   */\n  function parentIfText(node) {\n    return 'tagName' in node ? node : node.parentNode\n  }\n\n  /**\n   * @param {number} x1\n   * @param {number} x2\n   * @param {number} y1\n   * @param {number} y2\n   */\n  function swipeDirection(x1, x2, y1, y2) {\n    return Math.abs(x1 - x2) >= Math.abs(y1 - y2)\n      ? x1 - x2 > 0\n        ? 'left'\n        : 'right'\n      : y1 - y2 > 0\n      ? 'up'\n      : 'down'\n  }\n\n  function longTap(event) {\n    longTapTimeout = null\n    if (touch.last) {\n      try {\n        if (touch && touch.el) {\n          trigger(touch.el, 'longtap', null, event)\n          touch = {}\n        }\n      } catch (err) {}\n    }\n  }\n\n  function cancelLongTap() {\n    if (longTapTimeout) clearTimeout(longTapTimeout)\n    longTapTimeout = null\n  }\n\n  function cancelAll() {\n    if (touchTimeout) clearTimeout(touchTimeout)\n    if (tapTimeout) clearTimeout(tapTimeout)\n    if (swipeTimeout) clearTimeout(swipeTimeout)\n    if (longTapTimeout) clearTimeout(longTapTimeout)\n    touchTimeout = tapTimeout = swipeTimeout = longTapTimeout = null\n    touch = {}\n  }\n\n  /**\n   * Execute this after DOM loads:\n   */\n  ;(function(target) {\n    var now\n    var delta\n    var element = target || document.body\n\n    /**\n     * Capture start of event:\n     */\n    element.addEventListener(eventstart, function(e) {\n      now = Date.now()\n      delta = now - (touch.last || now)\n\n      if (eventstart === 'mousedown') {\n        touch.el = parentIfText(/** @type{Node} */ (e.target))\n        if (e.target['nodeName'] === 'ripple') {\n          touch.el = e.target['parentNode']\n        }\n        touchTimeout && clearTimeout(touchTimeout)\n        touch.x1 = e['pageX']\n        touch.y1 = e['pageY']\n\n        /**\n         * Detect one finger gesture:\n         */\n      } else {\n        if (e['touches'].length === 1) {\n          if (!!e.target['disabled']) return\n          touch.el = parentIfText(e['touches'][0].target)\n          touchTimeout && clearTimeout(touchTimeout)\n          touch.x1 = e['touches'][0]['pageX']\n          touch.y1 = e['touches'][0]['pageY']\n        }\n      }\n\n      if (delta > 0 && delta <= 450) {\n        touch.isDoubleTap = true\n      }\n      touch.last = now\n      longTapTimeout = setTimeout(longTap, longTapDelay, e)\n    })\n\n    /**\n     * Capture event move:\n     */\n    element.addEventListener(eventmove, function(e) {\n      cancelLongTap()\n      if (eventmove === 'mousemove') {\n        touch.x2 = e['pageX']\n        touch.y2 = e['pageY']\n      } else {\n        /**\n         * One finger gesture:\n         */\n        if (e['touches'].length === 1) {\n          touch.x2 = e['touches'][0]['pageX']\n          touch.y2 = e['touches'][0]['pageY']\n          touch.move = true\n        } else if (e['touches'].length === 2) {\n          // TODO: pinch - rotate gestures?\n        }\n      }\n    })\n\n    /**\n     * Capture event end:\n     */\n    element.addEventListener(eventend, function(e) {\n      cancelLongTap()\n      if (!!touch.el) {\n        /**\n         * Swipe detection:\n         */\n        if (\n          (touch.x2 && Math.abs(touch.x1 - touch.x2) > gestureLength) ||\n          (touch.y2 && Math.abs(touch.y1 - touch.y2) > gestureLength)\n        ) {\n          swipeTimeout = setTimeout(function() {\n            if (touch && touch.el) {\n              var direction = swipeDirection(\n                touch.x1,\n                touch.x2,\n                touch.y1,\n                touch.y2\n              )\n              trigger(touch.el, 'swipe', direction, e)\n              trigger(touch.el, 'swipe' + direction, null, e)\n              touch = {}\n            }\n          }, 0)\n\n          /**\n           * Normal tap:\n           */\n        } else if ('last' in touch) {\n          /**\n           * Delay by one tick so we can cancel the 'tap' event if 'scroll' fires:\n           */\n          tapTimeout = setTimeout(function() {\n            /**\n             * Trigger double tap immediately:\n             */\n            if (touch && touch.isDoubleTap) {\n              if (touch && touch.el) {\n                trigger(touch.el, 'dbltap', null, e)\n                e.preventDefault()\n                touch = {}\n              }\n            } else {\n              /**\n               * Trigger tap after singleTapDelay:\n               */\n              touchTimeout = setTimeout(function() {\n                touchTimeout = null\n                if (touch && touch.el && !touch.move) {\n                  trigger(touch.el, 'tap', null, e)\n                  touch = {}\n                } else {\n                  /**\n                   * Touch moved, so cancel tap:\n                   */\n                  cancelAll()\n                }\n              }, singleTapDelay)\n            }\n          }, 0)\n        }\n      } else {\n        return\n      }\n    })\n    element.addEventListener('touchcancel', cancelAll)\n  })(target)\n}\n\n/**\n * Function to disable text selection. Use with make swipe events not select the element's text.\n * @param {Element} element\n * @param {string | boolean} [all]\n * @return {void} undefined\n */\nexport function disableTextSelection(element, all) {\n  if (!element) return\n  if (all && typeof element === 'string') {\n    var elements = Array.prototype.slice.call(\n      document.querySelectorAll(element)\n    )\n    elements.map(function(element) {\n      element.classList.add('disable-user-select')\n    })\n  } else {\n    if (typeof element === 'string') {\n      element = document.querySelector(element)\n      element.classList.add('disable-user-select')\n    }\n  }\n  var stylesheet = document.head.querySelector('.disable-user-select')\n  if (!stylesheet) {\n    stylesheet = document.createElement('style')\n    stylesheet.className = 'disable-user-select'\n    stylesheet.innerHTML =\n      '.disable-user-select, .disable-user-select * { user-select: none; -webkit-user-select: none; -ms-user-select: none; }'\n    document.head.appendChild(stylesheet)\n  }\n}\n\n/**\n * Function to remove a style set to disable text selection. This will re-enable text selection.\n * @param {Element} element\n * @param {string | boolean} all\n * @return {void} undefined\n */\nexport function enableTextSelection(element, all) {\n  if (all && typeof element === 'string') {\n    var elements = Array.prototype.slice.call(\n      document.querySelectorAll(element)\n    )\n    elements.map(function(element) {\n      element.classList.remove('disable-user-select')\n    })\n  } else {\n    if (typeof element === 'string') element = document.querySelector(element)\n    if (!element) return\n    element.classList.remove('disable-user-select')\n  }\n}\n"],"names":["eventstart","eventend","eventmove","eventcancel","window","navigator","pointerEnabled","msPointerEnabled","trigger","el","event","data","originalEvent","console","error","document","querySelector","createEvent","evtObj","initEvent","dispatchEvent","gestures","target","Math","abs","parentIfText","node","parentNode","swipeDirection","x1","x2","y1","y2","longTap","longTapTimeout","touch","last","err","cancelLongTap","clearTimeout","cancelAll","touchTimeout","tapTimeout","swipeTimeout","singleTapDelay","gestureLength","test","userAgent","now","delta","element","body","addEventListener","e","Date","length","isDoubleTap","setTimeout","move","direction","preventDefault","disableTextSelection","all","elements","Array","prototype","slice","call","querySelectorAll","map","classList","add","stylesheet","head","createElement","className","innerHTML","appendChild","enableTextSelection","remove"],"mappings":"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"}