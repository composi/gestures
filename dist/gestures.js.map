{"version":3,"file":"gestures.js.map","sources":["../src/gestures.js"],"sourcesContent":["/**\n * @type {string} eventstart\n */\nvar eventstart\n/**\n * @type {string} eventend\n */\nvar eventend\n/**\n * @type {string} eventmove\n */\nvar eventmove\n/**\n * @type {string} eventcancel\n */\nvar eventcancel\n\n// Pointer events for IE11 and MSEdge:\nif (window.navigator.pointerEnabled) {\n  eventstart = 'pointerdown'\n  eventend = 'pointerup'\n  eventmove = 'pointermove'\n  eventcancel = 'pointercancel'\n\n  // Pointer events for IE10 and WP8:\n} else if (window.navigator.msPointerEnabled) {\n  eventstart = 'MSPointerDown'\n  eventend = 'MSPointerUp'\n  eventmove = 'MSPointerMove'\n  eventcancel = 'MSPointerCancel'\n\n  // Touch events for iOS & Android:\n} else if ('ontouchstart' in window) {\n  eventstart = 'touchstart'\n  eventend = 'touchend'\n  eventmove = 'touchmove'\n  eventcancel = 'touchcancel'\n\n  // Mouse events for desktop:\n} else {\n  eventstart = 'mousedown'\n  eventend = 'mouseup'\n  eventmove = 'mousemove'\n  eventcancel = 'mouseout'\n}\nexport { eventstart, eventend, eventmove, eventcancel }\n\n/**\n * Fire a gesture on an element and pass it some optional data.\n * @param {Element} el\n * @param {string} event\n * @param {*} [data]\n * @param {Event} originalEvent\n */\nexport function trigger(el, event, data, originalEvent) {\n  if (!event) {\n    console.error('No event was provided. You do need to provide one.')\n    return\n  }\n  if (typeof el === 'string') el = document.querySelector(el)\n  if (document.createEvent) {\n    var evtObj = document.createEvent('Events')\n    evtObj.initEvent(event, true, false)\n    evtObj['data'] = data\n    evtObj['originalEvent'] = originalEvent\n    el.dispatchEvent(evtObj)\n  }\n}\n\n/**\n * Enable gestures in the browser.\n * @return {void} undefined\n */\nexport var gestures = function() {\n  var touch = {}\n  var touchTimeout\n  var swipeTimeout\n  var tapTimeout\n  var longTapDelay = 750\n  var singleTapDelay = 150\n  var gestureLength = 20\n  if (/android/gim.test(navigator.userAgent)) singleTapDelay = 200\n  var longTapTimeout\n\n  /**\n   * @param {Node} node\n   */\n  function parentIfText(node) {\n    return 'tagName' in node ? node : node.parentNode\n  }\n\n  /**\n   * @param {number} x1\n   * @param {number} x2\n   * @param {number} y1\n   * @param {number} y2\n   */\n  function swipeDirection(x1, x2, y1, y2) {\n    return Math.abs(x1 - x2) >= Math.abs(y1 - y2)\n      ? x1 - x2 > 0\n        ? 'left'\n        : 'right'\n      : y1 - y2 > 0\n      ? 'up'\n      : 'down'\n  }\n\n  function longTap(event) {\n    longTapTimeout = null\n    if (touch.last) {\n      try {\n        if (touch && touch.el) {\n          trigger(touch.el, 'longtap', null, event)\n          touch = {}\n        }\n      } catch (err) {}\n    }\n  }\n\n  function cancelLongTap() {\n    if (longTapTimeout) clearTimeout(longTapTimeout)\n    longTapTimeout = null\n  }\n\n  function cancelAll() {\n    if (touchTimeout) clearTimeout(touchTimeout)\n    if (tapTimeout) clearTimeout(tapTimeout)\n    if (swipeTimeout) clearTimeout(swipeTimeout)\n    if (longTapTimeout) clearTimeout(longTapTimeout)\n    touchTimeout = tapTimeout = swipeTimeout = longTapTimeout = null\n    touch = {}\n  }\n\n  /**\n   * Execute this after DOM loads:\n   */\n  ;(function() {\n    var now\n    var delta\n    var body = document.body\n\n    /**\n     * Capture start of event:\n     */\n    body.addEventListener(eventstart, function(e) {\n      now = Date.now()\n      delta = now - (touch.last || now)\n\n      if (eventstart === 'mousedown') {\n        touch.el = parentIfText(/** @type{Node} */ (e.target))\n        if (e.target['nodeName'] === 'ripple') {\n          touch.el = e.target['parentNode']\n        }\n        touchTimeout && clearTimeout(touchTimeout)\n        touch.x1 = e['pageX']\n        touch.y1 = e['pageY']\n\n        /**\n         * Detect one finger gesture:\n         */\n      } else {\n        if (e['touches'].length === 1) {\n          if (!!e.target['disabled']) return\n          touch.el = parentIfText(e['touches'][0].target)\n          touchTimeout && clearTimeout(touchTimeout)\n          touch.x1 = e['touches'][0]['pageX']\n          touch.y1 = e['touches'][0]['pageY']\n        }\n      }\n\n      if (delta > 0 && delta <= 450) {\n        touch.isDoubleTap = true\n      }\n      touch.last = now\n      longTapTimeout = setTimeout(longTap, longTapDelay, e)\n    })\n\n    /**\n     * Capture event move:\n     */\n    body.addEventListener(eventmove, function(e) {\n      cancelLongTap()\n      if (eventmove === 'mousemove') {\n        touch.x2 = e['pageX']\n        touch.y2 = e['pageY']\n      } else {\n        /**\n         * One finger gesture:\n         */\n        if (e['touches'].length === 1) {\n          touch.x2 = e['touches'][0]['pageX']\n          touch.y2 = e['touches'][0]['pageY']\n          touch.move = true\n        } else if (e['touches'].length === 2) {\n          // TODO: pinch - rotate gestures?\n        }\n      }\n    })\n\n    /**\n     * Capture event end:\n     */\n    body.addEventListener(eventend, function(e) {\n      cancelLongTap()\n      if (!!touch.el) {\n        /**\n         * Swipe detection:\n         */\n        if (\n          (touch.x2 && Math.abs(touch.x1 - touch.x2) > gestureLength) ||\n          (touch.y2 && Math.abs(touch.y1 - touch.y2) > gestureLength)\n        ) {\n          swipeTimeout = setTimeout(function() {\n            if (touch && touch.el) {\n              var direction = swipeDirection(\n                touch.x1,\n                touch.x2,\n                touch.y1,\n                touch.y2\n              )\n              trigger(touch.el, 'swipe', direction, e)\n              trigger(touch.el, 'swipe' + direction, null, e)\n              touch = {}\n            }\n          }, 0)\n\n          /**\n           * Normal tap:\n           */\n        } else if ('last' in touch) {\n          /**\n           * Delay by one tick so we can cancel the 'tap' event if 'scroll' fires:\n           */\n          tapTimeout = setTimeout(function() {\n            /**\n             * Trigger double tap immediately:\n             */\n            if (touch && touch.isDoubleTap) {\n              if (touch && touch.el) {\n                trigger(touch.el, 'dbltap', null, e)\n                e.preventDefault()\n                touch = {}\n              }\n            } else {\n              /**\n               * Trigger tap after singleTapDelay:\n               */\n              touchTimeout = setTimeout(function() {\n                touchTimeout = null\n                if (touch && touch.el && !touch.move) {\n                  trigger(touch.el, 'tap', null, e)\n                  touch = {}\n                } else {\n                  /**\n                   * Touch moved, so cancel tap:\n                   */\n                  cancelAll()\n                }\n              }, singleTapDelay)\n            }\n          }, 0)\n        }\n      } else {\n        return\n      }\n    })\n    body.addEventListener('touchcancel', cancelAll)\n  })()\n}\n\n/**\n * Function to disable text selection. Use with make swipe events not select the element's text.\n * @param {Element} element\n * @param {string | boolean} [all]\n * @return {void} undefined\n */\nexport function disableTextSelection(element, all) {\n  if (!element) return\n  if (all && typeof element === 'string') {\n    var elements = Array.prototype.slice.call(\n      document.querySelectorAll(element)\n    )\n    elements.map(function(element) {\n      element.classList.add('disable-user-select')\n    })\n  } else {\n    if (typeof element === 'string') {\n      element = document.querySelector(element)\n      element.classList.add('disable-user-select')\n    }\n  }\n  var stylesheet = document.head.querySelector('.disable-user-select')\n  if (!stylesheet) {\n    stylesheet = document.createElement('style')\n    stylesheet.className = 'disable-user-select'\n    stylesheet.innerHTML =\n      '.disable-user-select, .disable-user-select * { user-select: none; -webkit-user-select: none; -ms-user-select: none; }'\n    document.head.appendChild(stylesheet)\n  }\n}\n\n/**\n * Function to remove a style set to disable text selection. This will re-enable text selection.\n * @param {Element} element\n * @param {string | boolean} all\n * @return {void} undefined\n */\nexport function enableTextSelection(element, all) {\n  if (all && typeof element === 'string') {\n    var elements = Array.prototype.slice.call(\n      document.querySelectorAll(element)\n    )\n    elements.map(function(element) {\n      element.classList.remove('disable-user-select')\n    })\n  } else {\n    if (typeof element === 'string') element = document.querySelector(element)\n    if (!element) return\n    element.classList.remove('disable-user-select')\n  }\n}\n"],"names":["trigger","el","event","data","originalEvent","console","error","document","querySelector","createEvent","evtObj","initEvent","dispatchEvent","window","navigator","pointerEnabled","eventstart","eventend","eventmove","eventcancel","msPointerEnabled","Math","abs","parentIfText","node","parentNode","swipeDirection","x1","x2","y1","y2","longTap","longTapTimeout","touch","last","err","cancelLongTap","clearTimeout","cancelAll","touchTimeout","tapTimeout","swipeTimeout","singleTapDelay","gestureLength","test","userAgent","now","delta","body","addEventListener","e","Date","target","length","isDoubleTap","setTimeout","move","direction","preventDefault","element","all","elements","Array","prototype","slice","call","querySelectorAll","map","classList","add","stylesheet","head","createElement","className","innerHTML","appendChild","remove"],"mappings":"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"}